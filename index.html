<!DOCTYPE html>
<html>
    <head>
     <title>fuck test is coming</title>
     <meta charset="utf-8">
    <meta name="description" content="서울삼육중학교 개 좆같네">
    <meta property="og:title" content="PSJ">
     <link rel="preconnect" href="https://fonts.googleapis.com">
     <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
     <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR&family=Poppins&display=swap" rel="stylesheet">
     </head>
    <body style="font-family:Poppins, Noto Sans KR, sans-serif;margin: 0">
     <div style="background-color: #703fda; color: #ffffff; text-align: center;">
      <h1 style="color:#ffffff;font-weight: 300;">시험을 앞둔 기분을 작성해주세요</h1>
      <p>
        <span style="font-weight:700;">12월 7일 기준</span>
      </p>
    </div>
    <div style="width: 560px;margin: 32px;margin: 0 auto">
      <div style="text-align: right; margin-bottom: 20px;">
        <button id="adminBtn" onclick="openAdminLogin()" style="padding: 8px 15px; background-color: #999; color: #ffffff; border: none; border-radius: 4px; cursor: pointer; font-weight: bold;">관리자</button>
      </div>
      
      <!-- 관리자 모달 -->
      <div id="adminModal" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background-color: rgba(0,0,0,0.5); z-index: 1000;">
        <div style="background-color: #ffffff; width: 90%; max-width: 600px; margin: 50px auto; padding: 30px; border-radius: 8px; box-shadow: 0 4px 16px rgba(0,0,0,0.2);">
          <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
            <h2 style="color: #703fda; margin: 0;">관리자 패널</h2>
            <button onclick="closeAdminModal()" style="background: none; border: none; font-size: 24px; cursor: pointer; color: #999;">×</button>
          </div>
          
          <div id="loginView">
            <div style="margin-bottom: 15px;">
              <label style="display: block; margin-bottom: 5px; color: #2e2e2e; font-weight: bold;">비밀번호:</label>
              <input type="password" id="adminPassword" placeholder="관리자 비밀번호" style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 4px; font-family: inherit;">
            </div>
            <button onclick="adminLogin()" style="width: 100%; padding: 10px; background-color: #7844e8; color: #ffffff; border: none; border-radius: 4px; cursor: pointer; font-weight: bold;">로그인</button>
          </div>
          
          <div id="adminView" style="display: none;">
            <div style="margin-bottom: 20px;">
              <div style="display: flex; gap: 10px; margin-bottom: 20px;">
                <button onclick="switchAdminTab('comments')" id="commentsTab" style="flex: 1; padding: 10px; background-color: #7844e8; color: #ffffff; border: none; border-radius: 4px; cursor: pointer; font-weight: bold;">댓글 관리</button>
                <button onclick="switchAdminTab('logs')" id="logsTab" style="flex: 1; padding: 10px; background-color: #ddd; color: #2e2e2e; border: none; border-radius: 4px; cursor: pointer; font-weight: bold;">접속 로그</button>
              </div>
            </div>
            
            <div id="commentsView" style="max-height: 400px; overflow-y: auto;">
              <div id="adminCommentsList"></div>
            </div>
            
            <div id="logsView" style="display: none; max-height: 400px; overflow-y: auto;">
              <div id="adminLogsList"></div>
            </div>
            
            <button onclick="adminLogout()" style="width: 100%; padding: 10px; background-color: #999; color: #ffffff; border: none; border-radius: 4px; cursor: pointer; font-weight: bold; margin-top: 20px;">로그아웃</button>
          </div>
        </div>
      </div>
      
      <h2 style="color: #2e2e2e; font-size: 20px">
        <br>
        
      </h2>
      <img src="http://image.toast.com/aaaaaaq/iamschool/test/LOGO_IMAGE/170337890708924164.PNG" style="width: 100%;">
      <p>
    
           </p>      <p style="text-align: center;">        <a href="https://www.youtube.com/shorts/YEhDlkBl_D0" style="font-size: 32px; display: inline-block;">
          최은숙
        </a>
      </p>
      <div style="background-color: #f0f0f0; padding: 20px; margin-top: 20px; border-radius: 8px;">
        <h3 style="color: #2e2e2e;">코멘트를 남겨주세요</h3>
        <form id="commentForm" style="display: flex; flex-direction: column; gap: 10px;">
          <input type="text" id="name" placeholder="이름" style="padding: 10px; border: 1px solid #ddd; border-radius: 4px; font-family: inherit;" required>
          <textarea id="content" placeholder="코멘트를 입력하세요" style="padding: 10px; border: 1px solid #ddd; border-radius: 4px; font-family: inherit; min-height: 100px; resize: vertical;" required></textarea>
          <button type="submit" style="padding: 10px 20px; background-color: #7844e8; color: #ffffff; border: none; border-radius: 4px; cursor: pointer; font-weight: bold;">제출</button>
        </form>
        <div id="message" style="margin-top: 10px; color: #7844e8;"></div>
      </div>
      
      <div style="margin-top: 30px;">
        <h3 style="color: #2e2e2e;">댓글 목록</h3>
        <div id="commentsList"></div>
      </div>
      
      <script>
        const form = document.getElementById('commentForm');
        const nameInput = document.getElementById('name');
        const contentInput = document.getElementById('content');
        const messageDiv = document.getElementById('message');
        const commentsList = document.getElementById('commentsList');
        
        let adminPassword = '';
        let isAdmin = false;
        
        // 관리자 로그인
        function adminLogin() {
          const password = document.getElementById('adminPassword').value;
          
          if (!password) {
            alert('비밀번호를 입력해주세요');
            return;
          }
          
          // 임시로 비밀번호 검증 (실제로는 서버에서 검증됨)
          adminPassword = password;
          
          fetch(`/api/admin/logs?password=${password}`)
            .then(res => res.json())
            .then(data => {
              if (data.success) {
                isAdmin = true;
                document.getElementById('loginView').style.display = 'none';
                document.getElementById('adminView').style.display = 'block';
                loadAdminComments();
                loadAdminLogs();
              } else {
                alert(data.message);
              }
            })
            .catch(err => {
              alert('오류: ' + err.message);
            });
        }
        
        function adminLogout() {
          isAdmin = false;
          adminPassword = '';
          document.getElementById('adminPassword').value = '';
          document.getElementById('loginView').style.display = 'block';
          document.getElementById('adminView').style.display = 'none';
        }
        
        function openAdminLogin() {
          document.getElementById('adminModal').style.display = 'block';
        }
        
        function closeAdminModal() {
          if (isAdmin) {
            adminLogout();
          }
          document.getElementById('adminModal').style.display = 'none';
        }
        
        function switchAdminTab(tab) {
          if (tab === 'comments') {
            document.getElementById('commentsView').style.display = 'block';
            document.getElementById('logsView').style.display = 'none';
            document.getElementById('commentsTab').style.backgroundColor = '#7844e8';
            document.getElementById('commentsTab').style.color = '#ffffff';
            document.getElementById('logsTab').style.backgroundColor = '#ddd';
            document.getElementById('logsTab').style.color = '#2e2e2e';
          } else {
            document.getElementById('commentsView').style.display = 'none';
            document.getElementById('logsView').style.display = 'block';
            document.getElementById('commentsTab').style.backgroundColor = '#ddd';
            document.getElementById('commentsTab').style.color = '#2e2e2e';
            document.getElementById('logsTab').style.backgroundColor = '#7844e8';
            document.getElementById('logsTab').style.color = '#ffffff';
          }
        }
        
        function loadAdminComments() {
          fetch(`/api/admin/logs?password=${adminPassword}`)
            .then(res => res.json())
            .then(data => {
              if (data.success) {
                const list = document.getElementById('adminCommentsList');
                list.innerHTML = '';
                
                if (data.comments.length === 0) {
                  list.innerHTML = '<p style="color: #999;">댓글이 없습니다</p>';
                  return;
                }
                
                data.comments.forEach(comment => {
                  const div = document.createElement('div');
                  div.style.cssText = 'background-color: #f9f9f9; padding: 15px; margin-bottom: 10px; border-left: 4px solid #7844e8; border-radius: 4px;';
                  div.innerHTML = `
                    <strong style="color: #7844e8;">${comment.name}</strong> <small style="color: #999;">(ID: ${comment.id})</small>
                    <p style="margin: 10px 0; color: #2e2e2e;">${comment.content}</p>
                    <small style="color: #999;">${comment.date}</small>
                    <button onclick="deleteAdminComment(${comment.id})" style="display: block; margin-top: 10px; padding: 5px 10px; background-color: #ff6b6b; color: #ffffff; border: none; border-radius: 4px; cursor: pointer; font-size: 12px;">삭제</button>
                  `;
                  list.appendChild(div);
                });
              }
            });
        }
        
        function deleteAdminComment(id) {
          if (!confirm('이 댓글을 삭제하시겠습니까?')) {
            return;
          }
          
          fetch(`/api/comments/${id}`, {
            method: 'DELETE',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({ password: adminPassword })
          })
            .then(res => res.json())
            .then(data => {
              if (data.success) {
                alert('댓글이 삭제되었습니다');
                loadAdminComments();
              } else {
                alert(data.message);
              }
            });
        }
        
        function loadAdminLogs() {
          fetch(`/api/admin/logs?password=${adminPassword}`)
            .then(res => res.json())
            .then(data => {
              if (data.success) {
                const list = document.getElementById('adminLogsList');
                list.innerHTML = `<div style="margin-bottom: 20px; padding: 15px; background-color: #f0f0f0; border-radius: 4px;"><strong>총 댓글 수: ${data.commentCount}</strong></div>`;
                
                data.logs.forEach(log => {
                  const div = document.createElement('div');
                  div.style.cssText = 'background-color: #f9f9f9; padding: 10px; margin-bottom: 10px; border-left: 4px solid #7844e8; border-radius: 4px; font-size: 14px;';
                  div.innerHTML = `
                    <strong>${log.timestamp}</strong><br>
                    <small style="color: #666;">${log.method} ${log.path} | IP: ${log.ip}</small>
                  `;
                  list.appendChild(div);
                });
              }
            });
        }
        
        // 댓글 로드
        function loadComments() {
          fetch('/api/comments')
            .then(res => res.json())
            .then(comments => {
              commentsList.innerHTML = '';
              if (Array.isArray(comments)) {
                comments.forEach(comment => {
                  const div = document.createElement('div');
                  div.style.cssText = 'background-color: #ffffff; padding: 15px; margin-bottom: 10px; border-radius: 4px; border-left: 4px solid #7844e8;';
                  div.innerHTML = `
                    <strong style="color: #7844e8;">${comment.name}</strong>
                    <p style="margin: 5px 0; color: #2e2e2e;">${comment.content}</p>
                    <small style="color: #999;">${comment.date}</small>
                  `;
                  commentsList.appendChild(div);
                });
              }
            })
            .catch(err => {
              console.error('댓글 로드 오류:', err);
              commentsList.innerHTML = '<p style="color: #ff0000;">댓글을 불러올 수 없습니다.</p>';
            });
        }
        
        // 폼 제출
        form.addEventListener('submit', async (e) => {
          e.preventDefault();
          
          try {
            const res = await fetch('/api/comments', {
              method: 'POST',
              headers: { 'Content-Type': 'application/json' },
              body: JSON.stringify({
                name: nameInput.value,
                content: contentInput.value
              })
            });
            
            const data = await res.json();
            
            if (data.success) {
              messageDiv.textContent = '댓글이 등록되었습니다!';
              messageDiv.style.color = '#7844e8';
              nameInput.value = '';
              contentInput.value = '';
              setTimeout(() => messageDiv.textContent = '', 3000);
              loadComments();
            }
          } catch (err) {
            messageDiv.textContent = '오류: ' + err.message;
            messageDiv.style.color = '#ff0000';
          }
        });
        
        // 페이지 로드 시 댓글 로드
        loadComments();
      </script>
    </div>
    <div style="background-color: #f6f6fb; width: 550px;margin: 32px;margin: 0 auto">
      
      </p>
    </div>
    <div style="background-color: #7844e8; color: #ffffff;padding: 20px">
      <h2 style="text-align: center;">
        setter 안쓰고 만들었으니까
        이상한 사람들한테 공유하지 말아주세요^^
      </h2>
    </div>
    <div style="background-color: #2e2e2e; color: #ffffff; text-align: center;padding: 50px">
      <p>
        시험 끝나고 서버 닫습니다 ㅣ도배시 서버 접속 막을게요
      </p>
      <p>
       하고싶은말 다 남기세요
      </p>
      <p>
        (주)타코마신호드림치과 ㅣ 문의:010-5534-7351
      </p>
    </div>
   </body>
</html>